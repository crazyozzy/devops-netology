
# Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."


## Как сдавать задания

Обязательными к выполнению являются задачи без указания звездочки. Их выполнение необходимо для получения зачета и диплома о профессиональной переподготовке.

Задачи со звездочкой (*) являются дополнительными задачами и/или задачами повышенной сложности. Они не являются обязательными к выполнению, но помогут вам глубже понять тему.

Домашнее задание выполните в файле readme.md в github репозитории. В личном кабинете отправьте на проверку ссылку на .md-файл в вашем репозитории.

Любые вопросы по решению задач задавайте в чате учебной группы.

---

## Задача 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.
    
    Аппаратная виртуализация работает на "голом" железе (bare metal), т.е. нет необходимости устанавливать отдельную прослойку в виде ОС. Ресурсы хостовой машины поставляются гостевым ОС непосредственно гипервизором.

    Паравиртуализация работает непосредственно на базе какой-либо ОС (Linux, Windows и т.д.), т.е. аппаратными ресурсами управляет непосредвенно хостовая ОС, которая предоставляет их гипервизору, а тот в свою очередь гостевым ВМ.

    Виртуализация на основе ОС не использует непосредственно гипервизор, вместо этого гостевые ВМ соместно используют одно ядро хостовой ОС. Изоляция в Linux обеспецивается с помощью таких технологий встроенных в ядро как namespaces и cgroups.

## Задача 2

Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

Организация серверов:
- физические сервера,
- паравиртуализация,
- виртуализация уровня ОС.

Условия использования:
- Высоконагруженная база данных, чувствительная к отказу.
- Различные web-приложения.
- Windows системы для использования бухгалтерским отделом.
- Системы, выполняющие высокопроизводительные расчеты на GPU.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

| Условия использования | Лучший тип организации серверов | Комментарий |
| ------------- | ------------- | ------------- |
| Высоконагруженная база данных, чувствительная к отказу | физические сервера | Высоконагруженные и/или объемные базы данных рекомендуется размещать без применения технлогий виртуализации. Если избежать невозможно, то лучшим решением будет применение технологий аппаратной виртуалиации или паравиртуализации. Стоит сказать, что БД всё же размещают в контейнерах с привлечением оркестратора kubernetes/openshift, однако подобный подход требует серьезных подготовительных мероприятий и в общем и целом не стоит затрачиваемых усилий. |
| Различные web-приложения | виртуализация уровня ОС | Веб приложения это лучшие кандидаты для размещения в контейнерах с привлечением систем оркестрации kubernetes/openshift, так как их очень просто разворачивать, масштабировать и осуществлять балансировку нагрузки. |
| Windows системы для использования бухгалтерским отделом | паравиртуализация | Пожалуй лучшим решением для развертывания фермы терминальных серверов или каких-либо серверов приложений (видимо в вопросе подразумевается 1С) будут гипервизоры с применением паравиртуализации или аппаратные гипервизоры. Если под Windows системами имеются ввиду ВМ на которых непосредственно будут работать пользователи, подключаясь к ним например с помощью тонких клиентов, то тут тоже однозначно паравиртуализация или аппаратные гипервизоры с применением технологий VDI. |
| Системы, выполняющие высокопроизводительные расчеты на GPU | паравиртуализация/физические сервера | Если используем гипервизор поддерживает установленную модель GPU, то возможно применени технологий аппаратной или паравиртуализации, однако как показывает практика список поддерживаем GPU для "проброса" в ВМ крайне ограничен и как правило представляет из себя модели для профессионального использования, однако всегда можно пробросить GPU в одну ВМ в монопольном режиме как PCI устройство. |

## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:
1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

        1. В данном кейсе при условии использования преимущественно Windows лучшим решением будет применения Hyper-V либо ESXi c vSphere. Hyper-V подходит в силу преимущественно использования Windows, наличия встроенного балансировщика NLB, наличия технологий репликации между нодами кластера, а также встроенного инструмента для снятия резервных копий ВМ. Продукты от VmWare также имеют все обозначенные фичи (NSX, vSAN и т.д.), однако требуют дорогостоящих лицензий и предъявляют повышенные требования к квалификации инженеров.
        2. KVM так как является бесплатным open source решением и поддерживает виртуализацию любой распространенной гостевой ОС, а также имеет низкие накладные расходы на виртуализацию.
        3. Hyper-V является условно-бесплатным так как входит в стандартную лицензию на ОС Windows Server, а также это хорошее решение для виртуалиазации ОС Windows.
        4. KVM или Xen будут хорошими решениями для этих кейсов ввиду наличия отличных драйверов для Linux дистрибутивов. Из преимуществ KVM можно отметить нативную поддержку большинством современных ядер Linux, а Xen в свою очередь является наиболее стабильным.


## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

    Пожалуй основным недостатком можно назвать необходимость поддержки нескольких гипервизоров и/или технологий виртуализации, что накладывает повышенные требования к квалификации инженеров. Для минимизации проблем необходимо дублировать основные узлы инфраструктуры и поддерживать квалификацию инженеров на должном уровне. Вполне приемлемым вариантом является использование аппаратного/паравиртуального гипервизора и виртуализации на основе ОС. Например возможен вариант развертки серверов СУБД на аппаратных/паравиртуальных гипервизорах, а серверера приложений можно разместить в контейнерах (виртуализация на основе ОС) и применить оркестратор.
